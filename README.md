# Сервис сбора статистики устройств

Сервис сбора статистики устройств предоставляет API для сбора статистических данных с устройств, их анализа и хранения.

# Функциональность

- Сбор статистики с устройства по его идентификатору.
- Привязка устройств к пользователям.
- Анализ собранной статистики с устройства за определенный период и за все время.
- Анализ показаний устройств по идентификатору пользователя.
- Хранение собранных данных в базе данных MySQL.
- Возможность анализа показателей в асинхронном режиме при помощи фреймворка Celery.

# API Endpoint

| Ресурс                                            | Метод  | Что делает                                                      
| -----------                                       | -----  | ---                                                             
| /users                                            | POST   | Создает в базе данных новую запись пользователя, шифрует пароли 
| /stats/{device_id}                                | POST   | Заносит в базу данных считанную с устройства информацию         
| /stats/{device_id}/summary                        | GET    | Возвращает статистику по устройству(за определенный период если указан)   
| /users/{user_id}/stats/summary                    | GET    | Возвращает статистику по всем устройствам пользователя                        
| /users/{user_id}/devices/{device_id}/stats/summary| GET    | Возвращает статистику по конкретному устройству пользователя                 

# Запуск
Перед запуском необходимо установить переменные окружения
```bash
docker-compose up -d --build
```

# Документация

После запуска доступна документация: http://127.0.0.1:5000/docs

# Модули сервиса

- App - Точка входа в приложение, реализует FastAPI-приложение соответсвии с требованиями
- Schemas - Реализует Pydantic-схемы сущностей приложения
- Database - Реализует взаимодействией с базой данных - подключение к ней и sqalchemy-модели
- Config - Отвечает за подгрузку конфигурации
- Celery_app - Отвечает за работу обработчика задач Celery
- Tasks - Модуль с задачами для Celery  


